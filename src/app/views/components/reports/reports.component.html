<c-nav variant="tabs">
    <a [active]="true" [cTabContent]="tabContent" [routerLink] [tabPaneIdx]="0" cNavLink>Generate Reports</a>
    <a [cTabContent]="tabContent" [routerLink] [tabPaneIdx]="1" cNavLink>Charts</a>
    <a [cTabContent]="tabContent" [routerLink] [tabPaneIdx]="2" cNavLink>Forecasts</a>
</c-nav>

<c-tab-content #tabContent="cTabContent">


<c-tab-pane class="p-3">
        <div>
            <form class="row">

                <div class="col-4">
                    <c-form-check sizing="xl" switch color="secondary" ngModel="switchbol">
                        <input cFormCheckInput type="checkbox" (click)="toggleSwitch()" />
                        <label cFormCheckLabel>{{ rangeText }}</label>
                    </c-form-check>
                </div>
                <div class="col-4" *ngIf="!switchbol"></div>
                <div class="col-4 row-cols-sm-auto picker" *ngIf="!switchbol">
                    <div class="input-group">
                        <button cButton color="secondary" (click)="generateReport()">Generate</button>
                        <input  class="form-control" placeholder="Target date" name="dp" ngbDatepicker #d="ngbDatepicker" (dateSelect)="onDateSelectTarget($event)" [readonly]="true">
                        <button class="btn btn-outline-secondary calendar" (click)="d.toggle()" type="button" color="secondary"></button>
                    </div>
                </div>

                <div class="col-8 row-cols-sm-auto picker" *ngIf="switchbol">
                    <div class="input-group">
                        <button cButton color="secondary" (click)="generateReport()">Generate</button>
                        <input  class="form-control" placeholder="From date" name="fromdate" (dateSelect)="onDateSelectFrom($event)" ngModel="fromDate" ngbDatepicker #a="ngbDatepicker"[readonly]="true" >
                        <button class="btn btn-outline-secondary calendar" (click)="a.toggle()" type="button"></button>

                        <span class="separator">to</span>

                        <input  class="form-control" placeholder="Target date" name="targetdate" (dateSelect)="onDateSelectTarget($event)" ngModel="targetDate" ngbDatepicker #b="ngbDatepicker" [readonly]="true">
                        <button class="btn btn-outline-secondary calendar" (click)="b.toggle()" type="button"></button>
                    </div>
                </div>
            </form>

            <form class="row second-form" *ngIf="_generated">
                <div class="col-12">
                    <c-card>
                        <c-card-header>
                            <div class="row">
                                <div class="col-6">Sales Summary 
                                    <span>{{fromDate | date:'MMM dd, yyyy'}}</span>
                                    <span *ngIf="switchbol && ( fromDate && targetDate )"> to </span>
                                    <span>{{targetDate | date:'MMM dd, yyyy'}}</span>
                                </div>
                                <div class="col-6 summary-total" *ngIf="_total">Total Sales: {{ _total | currency:'Php '}}</div>
                            </div>
                        </c-card-header>
                        <c-card-body>
                            <mat-tab-group (selectedTabChange)="setTotal($event)" dynamicHeight>
                                <mat-tab *ngFor="let store of (franchiseStores | async)" label="{{store.store_name}}">
                                    <div class="mat-elevation-z8" *ngIf="( ordersRange | async )">

                                        <table mat-table [dataSource]="getData(store.store_id)">
                                      
                                          <ng-container matColumnDef="position">
                                            <th mat-header-cell *matHeaderCellDef> No. </th>
                                            <td mat-cell *matCellDef="let element, let idx=index"> {{idx + 1}} </td>
                                          </ng-container>
                                      
                                          <ng-container matColumnDef="order_time">
                                            <th mat-header-cell *matHeaderCellDef> Order Time </th>
                                            <td mat-cell *matCellDef="let element"> {{element.order_time | date:'HH:mm'}} </td>
                                          </ng-container>
                                          <ng-container matColumnDef="payment_type">
                                            <th mat-header-cell *matHeaderCellDef> Payment Type </th>
                                            <td mat-cell *matCellDef="let element"> {{element.payment_type | uppercase}} </td>
                                          </ng-container>
                                      
                                          <ng-container matColumnDef="payment_reference">
                                            <th mat-header-cell *matHeaderCellDef> Payment Ref </th>
                                            <td mat-cell *matCellDef="let element"> {{element.payment_reference | uppercase}} </td>
                                          </ng-container>

                                          <ng-container matColumnDef="order_total">
                                            <th mat-header-cell *matHeaderCellDef  class="order-total"> Order Total </th>
                                            <td mat-cell *matCellDef="let element" class="order-total"> {{element.order_total | currency: '' + ' '}} </td>
                                          </ng-container>
                                      
                                          <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                                          <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
                                        </table>
                                    
                                        <mat-paginator [pageSizeOptions]="[10, 20]"
                                                       showFirstLastButtons 
                                                       aria-label="Select Page">
                                        </mat-paginator>
                                    </div>
                                </mat-tab>
                            </mat-tab-group>
                            <button cButton class="button-download" color="secondary">Download as CSV</button>

                        </c-card-body>
                    </c-card>
                </div>
            </form>
        </div>
        
    </c-tab-pane>



    <c-tab-pane class="p-3">
        This is some placeholder content the <strong>Profile</strong> tab's associated content. Clicking another
        tab will toggle the visibility of this one for the next. The tab JavaScript swaps classes to control the
        content visibility and styling. You can use it with tabs, pills, and any other .nav-powered navigation.
    </c-tab-pane>
    <c-tab-pane class="p-3">
        This is some placeholder content the <strong>Contact</strong> tab's associated content. Clicking another
        tab will toggle the visibility of this one for the next. The tab JavaScript swaps classes to control the
        content visibility and styling. You can use it with tabs, pills, and any other .nav-powered navigation.
    </c-tab-pane>
</c-tab-content>